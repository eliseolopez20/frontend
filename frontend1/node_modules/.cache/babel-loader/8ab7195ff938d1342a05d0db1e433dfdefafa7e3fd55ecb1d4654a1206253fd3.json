{"ast":null,"code":"import _regeneratorRuntime from\"/Users/eliseolopez/Desktop/repo/e1-2023-1-grupo-9/frontend1/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/eliseolopez/Desktop/repo/e1-2023-1-grupo-9/frontend1/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/eliseolopez/Desktop/repo/e1-2023-1-grupo-9/frontend1/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import axios from'axios';import{MapContainer,TileLayer,Marker,Popup}from'react-leaflet';import\"leaflet/dist/leaflet.css\";import{Icon}from\"leaflet\";import{useAuth0}from\"@auth0/auth0-react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Map(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),markers=_useState4[0],setMarkers=_useState4[1];var _useAuth=useAuth0(),getAccessTokenSilently=_useAuth.getAccessTokenSilently;var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),token=_useState6[0],setToken=_useState6[1];var icon=new Icon({iconUrl:require(\"./img/marker.png\"),iconSize:[25,25]});useEffect(function(){function fetchToken(){return _fetchToken.apply(this,arguments);}function _fetchToken(){_fetchToken=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var token;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return getAccessTokenSilently();case 2:token=_context.sent;console.log(token);setToken(token);case 5:case\"end\":return _context.stop();}},_callee);}));return _fetchToken.apply(this,arguments);}fetchToken();},[getAccessTokenSilently]);useEffect(function(){if(!token)return;axios.get('https://api-g.lgbusiness.net/production/api/v1/events',{headers:{'Content-Type':'application/json','Authorization':\"\".concat(token)}}).then(function(response){setData(response.data.instances);setMarkers(response.data.instances.map(function(instance){return{lat:instance.latitude,lng:instance.longitude,name:instance.name};}));});},[token]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(MapContainer,{center:[-33.455275555427804,-70.6605295633026],zoom:10,style:{height:'100vh',width:'100%'},children:[/*#__PURE__*/_jsx(TileLayer,{url:\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",attribution:\"Map data \\xA9 <a href=\\\"https://www.openstreetmap.org/\\\">OpenStreetMap</a> contributors\"}),markers.map(function(marker){return/*#__PURE__*/_jsx(Marker,{position:[marker.lat,marker.lng],icon:icon,children:/*#__PURE__*/_jsx(Popup,{children:marker.name})},marker.name);})]})});}export default Map;","map":{"version":3,"names":["React","useEffect","useState","axios","MapContainer","TileLayer","Marker","Popup","Icon","useAuth0","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Map","_useState","_useState2","_slicedToArray","data","setData","_useState3","_useState4","markers","setMarkers","_useAuth","getAccessTokenSilently","_useState5","_useState6","token","setToken","icon","iconUrl","require","iconSize","fetchToken","_fetchToken","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","sent","console","log","stop","get","headers","concat","then","response","instances","map","instance","lat","latitude","lng","longitude","name","children","center","zoom","style","height","width","url","attribution","marker","position"],"sources":["/Users/eliseolopez/Desktop/repo/e1-2023-1-grupo-9/frontend1/src/map.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { MapContainer, TileLayer, Marker, Popup } from 'react-leaflet';\nimport \"leaflet/dist/leaflet.css\";\nimport { Icon } from \"leaflet\";\nimport { useAuth0 } from \"@auth0/auth0-react\";\n\nfunction Map() {\n\n  const [data, setData] = useState([]);\n  const [markers, setMarkers] = useState([]);\n\n  \n  const { getAccessTokenSilently } = useAuth0();\n  const [token, setToken] = useState(null);\n  \n  const icon = new Icon({\n    iconUrl: require(\"./img/marker.png\"),\n    iconSize: [25, 25]\n  });\n\n  useEffect(() => {\n    async function fetchToken() {\n      const token = await getAccessTokenSilently();\n      console.log(token)\n      setToken(token);\n    }\n    fetchToken();\n  }, [getAccessTokenSilently]);\n  \n  useEffect(() => {\n    if (!token) return;\n  \n    axios.get('https://api-g.lgbusiness.net/production/api/v1/events', {\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `${token}` \n      }\n    })\n    .then(response => {\n      setData(response.data.instances);\n      setMarkers(response.data.instances.map(instance => ({\n        lat: instance.latitude,\n        lng: instance.longitude,\n        name: instance.name\n      })));\n    });\n  }, [token]);\n\nreturn (\n  <>\n  <MapContainer center={[-33.455275555427804\t, -70.6605295633026]} zoom={10} style={{ height: '100vh', width: '100%'}}>\n      <TileLayer url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\" \n       attribution='Map data &copy; <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors'/>\n      {markers.map(marker => (\n        <Marker key={marker.name} position={[marker.lat, marker.lng]} icon={icon}>\n          <Popup>{marker.name}</Popup>\n        </Marker>\n      ))}\n    </MapContainer>\n  </>\n)\n\n\n\n}\n\nexport default Map;\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}