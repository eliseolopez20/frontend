{"ast":null,"code":"import _regeneratorRuntime from\"/Users/eliseolopez/Desktop/repo/e1-2023-1-grupo-9/frontend1/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/eliseolopez/Desktop/repo/e1-2023-1-grupo-9/frontend1/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/eliseolopez/Desktop/repo/e1-2023-1-grupo-9/frontend1/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useAuth0}from\"@auth0/auth0-react\";import React,{useState,useEffect}from'react';import axios from'axios';import jsPDF from\"jspdf\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Profile(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),tableData=_useState2[0],setTableData=_useState2[1];var _useAuth=useAuth0(),isAuthenticated=_useAuth.isAuthenticated,user=_useAuth.user;var userId=user===null||user===void 0?void 0:user.sub;var _useAuth2=useAuth0(),getAccessTokenSilently=_useAuth2.getAccessTokenSilently;var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),token=_useState4[0],setToken=_useState4[1];useEffect(function(){function fetchToken(){return _fetchToken.apply(this,arguments);}function _fetchToken(){_fetchToken=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var token;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return getAccessTokenSilently();case 2:token=_context.sent;setToken(token);case 4:case\"end\":return _context.stop();}},_callee);}));return _fetchToken.apply(this,arguments);}fetchToken();},[getAccessTokenSilently]);useEffect(function(){if(!token)return;// Return early if the token is null\naxios.get(\"https://api-g.lgbusiness.net/production/api/v1/events/purchase\",{headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)// Replace with your actual bearer token\n},params:{'user_id':userId}}).then(function(response){return setTableData(response.data.instances);});},[token]);function downloadTicket(item){var pdf=new jsPDF();// Agrega el contenido del ticket al PDF\npdf.text('PDF de compra',10,10);pdf.text(\"ID Compra: \".concat(item._id),10,20);pdf.text(\"Event ID: \".concat(item.eventId),10,30);pdf.text(\"Cantidad: \".concat(item.quantity),10,40);pdf.text(\"Status: \".concat(item.status),10,50);pdf.save(\"ticket_\".concat(item._id,\".pdf\"));}return/*#__PURE__*/_jsxs(\"div\",{children:[isAuthenticated&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Bienvenido, \",user.name,\"!!\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"id usuario \",userId,\" \"]}),/*#__PURE__*/_jsx(\"h2\",{children:\"Mis compras\"}),/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID Compra\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Event ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Cantidad\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Descargar ticket\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:tableData.length>0&&tableData.map(function(item){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:item._id}),/*#__PURE__*/_jsx(\"td\",{children:item.eventId}),/*#__PURE__*/_jsx(\"td\",{children:item.quantity}),/*#__PURE__*/_jsx(\"td\",{children:item.status}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return downloadTicket(item);},children:\"Descargar\"})})]},item._id);})})]})]}),!isAuthenticated&&/*#__PURE__*/_jsx(\"h1\",{children:\"Por favor ingresa para ver tus compras\"})]});}export default Profile;","map":{"version":3,"names":["useAuth0","React","useState","useEffect","axios","jsPDF","jsxs","_jsxs","jsx","_jsx","Fragment","_Fragment","Profile","_useState","_useState2","_slicedToArray","tableData","setTableData","_useAuth","isAuthenticated","user","userId","sub","_useAuth2","getAccessTokenSilently","_useState3","_useState4","token","setToken","fetchToken","_fetchToken","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","sent","stop","get","headers","concat","params","then","response","data","instances","downloadTicket","item","pdf","text","_id","eventId","quantity","status","save","children","name","length","map","onClick"],"sources":["/Users/eliseolopez/Desktop/repo/e1-2023-1-grupo-9/frontend1/src/profile.js"],"sourcesContent":["import { useAuth0 } from \"@auth0/auth0-react\";\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport jsPDF from \"jspdf\";\n\nfunction Profile() {\n  const [tableData, setTableData] = useState([]);\n  \n  const { isAuthenticated, user } = useAuth0();\n  const userId = user?.sub;\n\n\n  const { getAccessTokenSilently } = useAuth0();\n  const [token, setToken] = useState(null);\n\n  useEffect(() => {\n    async function fetchToken() {\n      const token = await getAccessTokenSilently();\n      setToken(token);\n    }\n    fetchToken();\n  }, [getAccessTokenSilently]);\n  \n  useEffect(() => {\n    if (!token) return; // Return early if the token is null\n    axios.get(`https://api-g.lgbusiness.net/production/api/v1/events/purchase`, {\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${token}` // Replace with your actual bearer token\n      },\n      params: {\n        'user_id': userId\n      }\n    })\n      .then(response => setTableData(response.data.instances));\n  }, [token]);\n  \n  function downloadTicket(item) {\n    const pdf = new jsPDF();\n    // Agrega el contenido del ticket al PDF\n    pdf.text('PDF de compra', 10, 10)\n    pdf.text(`ID Compra: ${item._id}`, 10, 20);\n    pdf.text(`Event ID: ${item.eventId}`, 10, 30);\n    pdf.text(`Cantidad: ${item.quantity}`, 10, 40);\n    pdf.text(`Status: ${item.status}`, 10, 50);\n\n    pdf.save(`ticket_${item._id}.pdf`);\n  }\n  \n\n\n  return (\n    <div>\n        \n      {isAuthenticated && (\n        <>\n        <h1>Bienvenido, {user.name}!!</h1>\n        <p>id usuario {userId} </p>\n        <h2>Mis compras</h2>\n        <table>\n            <thead>\n              <tr>\n                <th>ID Compra</th>\n                <th>Event ID</th>\n                <th>Cantidad</th>\n                <th>Status</th>\n                <th>Descargar ticket</th>\n              </tr>\n            </thead>\n            <tbody>\n              {tableData.length > 0 && tableData.map((item) => (\n                <tr key={item._id}>\n                  <td>{item._id}</td>\n                  <td>{item.eventId}</td>\n                  <td>{item.quantity}</td>\n                  <td>{item.status}</td>\n                  <td><button onClick={() => downloadTicket(item)}>Descargar</button></td>\n                </tr>\n              ))}\n            </tbody>\n        </table>\n        </>\n      )} \n\n      {!isAuthenticated && (\n        <h1>Por favor ingresa para ver tus compras</h1>\n      )}\n      \n    </div>\n  );\n\n              }\nexport default Profile;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}